Index: app/src/main/java/mx/examen3/MainActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package mx.examen3;\n\nimport androidx.appcompat.app.AppCompatActivity;\nimport androidx.core.content.ContextCompat;\n\nimport android.content.Context;\nimport android.content.Intent;\nimport android.database.SQLException;\nimport android.graphics.Bitmap;\nimport android.graphics.BitmapFactory;\nimport android.net.ConnectivityManager;\nimport android.net.NetworkInfo;\nimport android.os.AsyncTask;\nimport android.os.Bundle;\nimport android.os.Environment;\nimport android.os.StrictMode;\nimport android.util.LruCache;\nimport android.view.View;\nimport android.widget.Button;\nimport android.widget.ProgressBar;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\nimport com.google.firebase.storage.StorageReference;\n\nimport org.json.JSONArray;\nimport org.json.JSONException;\n\nimport java.io.File;\nimport java.io.FileNotFoundException;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.util.ArrayList;\nimport java.util.LinkedList;\nimport java.util.Queue;\n\npublic class MainActivity extends AppCompatActivity implements View.OnClickListener {\n\n    Button downloadFile, viewMoviesList, updateMovie;\n    ProgressBar progressBar;\n    TextView textView;\n    private LruCache<String, Bitmap> memoryCache;\n    ArrayList<Movie> movieList;\n    int cont = 0;\n    ConnectivityManager connectivityManager;\n    NetworkInfo networkInfo;\n    MovieDBAdapter movieDBAdapter;\n    Movie movie;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n\n        // Get max available VM memory, exceeding this amount will throw an\n        // OutOfMemory exception. Stored in kilobytes as LruCache takes an\n        // int in its constructor.\n        final int maxMemory = (int) (Runtime.getRuntime().maxMemory() / 1024);\n\n        // Use 1/8th of the available memory for this memory cache.\n        final int cacheSize = maxMemory / 8;\n\n        memoryCache = new LruCache<String, Bitmap>(cacheSize) {\n            @Override\n            protected int sizeOf(String key, Bitmap bitmap) {\n                // The cache size will be measured in kilobytes rather than\n                // number of items.\n                return bitmap.getByteCount() / 1024;\n            }\n        };\n\n        setContentView(R.layout.activity_main);\n        movieDBAdapter = new MovieDBAdapter(this);\n        movie = new Movie();\n        initViewComp();\n    }\n\n    public void initViewComp() {\n        progressBar = (ProgressBar) findViewById(R.id.progressBar);\n        textView = (TextView) findViewById(R.id.textView);\n        downloadFile = (Button) findViewById(R.id.downloadFile);\n        downloadFile.setOnClickListener(this);\n        viewMoviesList = (Button) findViewById(R.id.viewMoviesList);\n        viewMoviesList.setOnClickListener(this);\n        updateMovie = (Button) findViewById(R.id.updateMovie);\n        updateMovie.setOnClickListener(this);\n    }\n\n    public void addBitmapToMemoryCache(String key, Bitmap bitmap) {\n        if (getBitmapFromMemCache(key) == null) {\n            memoryCache.put(key, bitmap);\n        }\n    }\n\n    public Bitmap getBitmapFromMemCache(String key) {\n        return memoryCache.get(key);\n    }\n\n    @Override\n    public void onClick(View v){\n        Intent goToActivity;\n        switch (v.getId()) {\n\n            case R.id.downloadFile:\n                new Download().execute(Tools.imagesURL);\n                /*    */\n                    break;\n                case R.id.viewMoviesList:\n                    goToActivity= new Intent(v.getContext(), ViewMovieList.class);\n                    startActivityForResult(goToActivity,1);\n                    break;\n                case R.id.updateMovie:\n                    Intent goToActivity2= new Intent(v.getContext(), DeleteMovie.class);\n                    startActivityForResult(goToActivity2,2);\n                    break;\n                default:\n                    break;\n            }\n\n    }\n    private class Download extends AsyncTask <String, String, String> {\n        @Override\n        protected void onPreExecute() {\n            super.onPreExecute();\n            progressBar.post(new Runnable() {\n                @Override\n                public void run() {\n                    progressBar.setIndeterminate(true);\n\n                }\n            });\n\n        }\n        @Override\n        protected String doInBackground(String... URL) {\n            String imageURL = URL[0];\n            publishProgress(\"Empezando descarga\");\n            try {\n                Thread.sleep(1000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            //download files and create database\n            StrictMode.setThreadPolicy(new StrictMode.ThreadPolicy.Builder().permitNetwork().build());\n            connectivityManager = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);\n            networkInfo = connectivityManager.getActiveNetworkInfo();\n            if(networkInfo != null && networkInfo.isConnected()) {\n                //download file\n                try {\n                    Thread.sleep(500);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                File localFile = new File(ContextCompat.getExternalFilesDirs(getApplicationContext(),\n                        null)[1],\"movies.json\");\n\n                //get file to list of movies\n                try {\n                    JSONArray movieJSON = Tools.downloadJSONArray(localFile);\n                    movieList = Tools.jsonArrayToArrayList(movieJSON);\n                } catch (JSONException e) {\n                    e.printStackTrace();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n\n                //create database\n                for(int i = 0; i < movieList.size(); i++){\n                    try {\n                        movieDBAdapter.insertMovie(movieList.get(i));\n                    }catch (SQLException e){\n                        e.printStackTrace();\n                    }\n\n                }\n\n\n            }else{\n                publishProgress(\"Error de conexion\");\n            }\n\n\n            try {\n\n                publishProgress(\"Descargando imagenes\");\n                int i=0;\n                ArrayList<String> imageFileNames = movieDBAdapter.getMovieImages();\n                for(String imageFileName : imageFileNames){\n                    String localUrl = imageURL+imageFileName;\n                    InputStream input = new java.net.URL(localUrl).openStream();\n                    // Decode Bitmap\n                    Bitmap bitmap  = BitmapFactory.decodeStream(input);\n                    addBitmapToMemoryCache(imageFileName,bitmap);\n                    File localFile = new File(ContextCompat.getExternalFilesDirs(getApplicationContext(),\n                            null)[1],imageFileName);\n                    FileOutputStream out = new FileOutputStream(localFile);\n                    boolean compress = bitmap.compress(Bitmap.CompressFormat.JPEG, 100, out);// bmp is your Bitmap instance\n                    publishProgress(\"Descargando imagen: \"+(++i)+\"/\"+imageFileNames.size(),imageFileName);\n\n                }\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n\n            return \"Descarga exitosa\";\n        }\n\n        @Override\n        protected void onProgressUpdate(String... values) {\n            super.onProgressUpdate(values);\n            Bitmap image = null;\n            textView.setText(values[0]);\n/*\n            if(values.length == 2){\n                image = getBitmapFromMemCache(values[1]);\n                File localFile = new File(ContextCompat.getExternalFilesDirs(getApplicationContext(),\n                        null)[1],values[1]);\n                try  {\n                    FileOutputStream out = new FileOutputStream(localFile);\n                    boolean compress = image.compress(Bitmap.CompressFormat.PNG, 100, out);// bmp is your Bitmap instance\n// PNG is a lossless format, the compression factor (100) is ignored\n                } catch (FileNotFoundException e) {\n                    e.printStackTrace();\n                }\n            }\n*/\n        }\n\n        @Override\n        protected void onPostExecute(String result) {\n            progressBar.post(new Runnable() {\n                @Override\n                public void run() {\n                    progressBar.setIndeterminate(false);\n                }\n            });\n            textView.setText(\"\");\n\n            // Close progressdialog\n            Toast.makeText(getApplicationContext(), \"Descarga completa\", Toast.LENGTH_SHORT).show();\n        }\n    }\n\n\n}\n\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/mx/examen3/MainActivity.java	(revision 052e0e8da1543b6854be774155e5d3cd4fc0fa21)
+++ app/src/main/java/mx/examen3/MainActivity.java	(date 1605456643000)
@@ -21,6 +21,7 @@
 import android.widget.TextView;
 import android.widget.Toast;
 
+import com.google.firebase.storage.FirebaseStorage;
 import com.google.firebase.storage.StorageReference;
 
 import org.json.JSONArray;
@@ -47,10 +48,12 @@
     NetworkInfo networkInfo;
     MovieDBAdapter movieDBAdapter;
     Movie movie;
+    private StorageReference mStorageRef;
 
     @Override
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
+        mStorageRef = FirebaseStorage.getInstance().getReference();
 
         // Get max available VM memory, exceeding this amount will throw an
         // OutOfMemory exception. Stored in kilobytes as LruCache takes an
Index: .idea/.gitignore
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/.gitignore	(date 1605456499000)
+++ .idea/.gitignore	(date 1605456499000)
@@ -0,0 +1,2 @@
+# Default ignored files
+/shelf/
